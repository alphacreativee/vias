import{preloadImages}from"../../libs/utils.js";let isSafari=-1<navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome"),lenis=(isSafari||Splitting(),new Lenis({smooth:!0,lerp:.1,smoothTouch:!0,normalizeWheel:!0,gestureOrientation:"vertical",touchMultiplier:1.5}));function header(){ScrollTrigger.create({start:"top top",end:99999,onUpdate:e=>{100<=e.scroll()?$("header").addClass("header--scroll"):$("header").removeClass("header--scroll");var t,e=$(".cta-mess"),o=$("footer");e.length&&o.length&&(t=e[0].getBoundingClientRect(),o=o[0].getBoundingClientRect(),t.bottom>=o.top?(e.addClass("touching-footer"),console.log("CTA Mess is touching footer!")):e.removeClass("touching-footer"))}}),$(".back-top").on("click",function(e){e.preventDefault(),$("html, body").animate({scrollTop:0},"300")}),ScrollTrigger.create({trigger:"footer",start:"top bottom",end:"bottom top",onEnter:()=>{$(".cta-mess").addClass("near-footer"),console.log("CTA Mess entered footer area")},onLeave:()=>{$(".cta-mess").removeClass("near-footer"),console.log("CTA Mess left footer area")},onEnterBack:()=>{$(".cta-mess").addClass("near-footer")},onLeaveBack:()=>{$(".cta-mess").removeClass("near-footer")}});var e=$(".hamburger");let t=$(".header-sub-menu"),o=$("body");e.on("click",function(){$(this).toggleClass("active"),t.toggleClass("active"),o.toggleClass("overflow-hidden")})}function footer(){window.innerWidth;gsap.fromTo(".footer-main .data-zoom-in-footer",{scale:1.3,"will-change":"transform"},{scale:.8,duration:.4,ease:"none",scrollTrigger:{trigger:".footer-ovl .data-zoom-in-footer",start:"top 90%",scrub:!0}})}function hero(){$("section.hero").length<1||($(".hero-slider").each(function(){var e=$(this);let t;var o=e.attr("data-loop"),r=e.data("autoplay")?{delay:e.data("autoplay")}:e.data("autoplay");t=e.is("[data-speed]")?e.data("speed"):900,new Swiper(e[0],{direction:"vertical",speed:t,loop:o,autoplay:r,preloadImages:!0,parallax:!0,lazy:{loadPrevNext:!0},allowTouchMove:!1,simulateTouch:!1,mousewheel:!1,pagination:{el:".hero .swiper-pagination",clickable:!1,renderBullet:function(e,t){return`
            <button class="${t}">
            <svg class="progress" width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle class="circle-origin" cx="14" cy="14" r="13" stroke="white"/>
            </svg>
            </button>`}},navigation:{nextEl:".hero .swiper-button-next",prevEl:".hero .swiper-button-prev"},on:{init:function(){$(this.slides[this.activeIndex])}}})}),isSafari?gsap.utils.toArray("[effect-title]").forEach(e=>{gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:40},{opacity:1,y:0,duration:1,ease:"power2.out",delay:2})}):document.querySelectorAll("[data-splitting][effect-title]").forEach(e=>{var t=window.innerWidth<768,o=e.hasAttribute("data-disable-mobile");t&&o||(t=e.querySelectorAll(".char"),gsap.fromTo(t,{"will-change":"opacity, transform",opacity:0,y:20},{opacity:1,y:0,stagger:.04,scrollTrigger:{trigger:e,start:"top 60%",end:"bottom 60%"}}))}))}function discover(){$(".section-discover").length<1||(new Swiper(".swiper-discover",{slidesPerView:1,loop:!1,speed:1e3,spaceBetween:16,loopAdditionalSlides:8,parallax:!0,navigation:{nextEl:".section-discover .swiper-button-next",prevEl:".section-discover .swiper-button-prev"},pagination:{el:".section-discover .swiper-pagination",type:"progressbar"},breakpoints:{991:{slidesPerView:2,spaceBetween:24}}}),ScrollTrigger.create({trigger:".section-discover",start:"top 40%",end:"bottom 60%",toggleClass:{targets:"body, main",className:"discover-active"},scrub:!1}))}function sectionTestimonials(){$(".section-testimonials").length<1||new Swiper(".testimonials-slider",{slidesPerView:1,loop:!1,speed:1e3,spaceBetween:24,parallax:!1,navigation:{nextEl:".testimonials-arrow .swiper-button-next",prevEl:".testimonials-arrow .swiper-button-prev"},pagination:{el:".section-testimonials .swiper-pagination",type:"progressbar"},breakpoints:{1024:{slidesPerView:3,spaceBetween:24},767:{slidesPerView:2,spaceBetween:24}}})}function loading(){$(".loading").length<1||gsap.timeline({defaults:{duration:2,ease:"power2.inOut"}}).fromTo(".loading",{clipPath:"inset(0% 0% 0% 0%)"},{clipPath:"inset(0% 0% 100% 0%)",onComplete:()=>{document.querySelector(".loading").classList.add("d-none")}})}function customDropdown(){let n=$(".dropdown-custom");n.each(function(){let t=$(this),o=t.find(".dropdown-custom__btn"),r=t.find(".dropdown-custom__menu");var e=t.find(".dropdown-custom__item");let a=t.find(".dropdown-custom__text");function i(o){$(".dropdown-custom__btn").removeClass("active"),n.each(function(){var e=$(this).find(".dropdown-custom__menu"),t=$(this).find(".dropdown-custom__btn");o&&$(this).is(o)||(e.removeClass("dropdown--active"),t.removeClass("--active"))})}o.on("click",function(e){e.stopPropagation(),i(t),r.toggleClass("dropdown--active"),o.toggleClass("--active")}),$(document).on("click",function(){i()}),e.on("click",function(e){e.stopPropagation();e=$(this);let t=a.text();var o=a.find("img").attr("src"),r=e.find("img");a.text(e.text()),r.length?(a.html(e.html()),e.hasClass("language__item")&&(t=`<span>${t}</span>`),e.html(`${o?`<img src="${o}" />`:""} `+t)):e.hasClass("language__item")&&e.text(t),i()}),$(window).on("scroll",function(){i()})})}function animation(){gsap.utils.toArray(".data-fade-in").forEach(e=>{var t=window.innerWidth<768,o=e.hasAttribute("data-disable-mobile");t&&o||(t=e.getAttribute("data-offset")||"70%",gsap.fromTo(e,{opacity:0,y:20},{opacity:1,y:0,duration:1,ease:"power1.out",scrollTrigger:{trigger:e,start:"top "+t,end:"bottom "+t}}))}),gsap.utils.toArray(".data-zoom-in").forEach((e,t)=>{gsap.fromTo(e,{scale:1.1},{scrollTrigger:{trigger:e,start:"top 70%",end:"bottom 70%",onEnter:()=>{e.classList.add("done")}},scale:1,duration:.5,ease:"none",stagger:.1})}),gsap.utils.toArray(".parallax-trigger").forEach(e=>{var t=e.querySelector("img");gsap.timeline({scrollTrigger:{trigger:e,scrub:!0,pin:!1}}).fromTo(t,{yPercent:-10,ease:"none"},{yPercent:10,ease:"none"})}),window.innerWidth<1024||gsap.utils.toArray(".intro-content").forEach(e=>{var t=e.querySelector(".box");gsap.timeline({scrollTrigger:{trigger:e,scrub:!0,pin:!1}}).fromTo(t,{yPercent:-10,ease:"none"},{yPercent:10,ease:"none"})})}function sectionImage(){$(".section-image").length<1||(gsap.fromTo(".section-image .image-wrapper",{clipPath:"inset(0% 0% 0% 0%)"},{scrollTrigger:{trigger:".section-image",start:"top 70%",end:"bottom 70%",scrub:1},clipPath:()=>{var e=window.innerWidth;let t=e-32;var o=(e-(t=991<e?e-160:767<e?e-80:e-32))/2/e*100,r=document.querySelector(".section-image").offsetHeight,e=(r-(991<e?r-100:r))/2/r*100;return`inset(${e}% ${o}% ${e}% ${o}%)`},duration:.4,ease:"power2.out"}),gsap.fromTo(".section-image .image-wrapper img",{scale:1},{scrollTrigger:{trigger:".section-image",start:"top 70%",end:"bottom 70%",scrub:1},scale:1.1,duration:.4,ease:"power2.out"}))}function sliderParallax(){if(!($(".swiper-parallax-img").length<1))new Swiper(".swiper-parallax-img",{speed:1500,grabCursor:!0,watchSlidesProgress:!0,mousewheelControl:!0,keyboardControl:!0,navigation:{nextEl:".slider-parallax .swiper-button-next",prevEl:".slider-parallax .swiper-button-prev"},pagination:{el:".slider-parallax-pagination",type:"progressbar"},on:{progress:function(o){o.slides.forEach(function(e){var t=(e.progress||0)*(.9*o.width);isNaN(t)||(e=e.querySelector(".slider-parallax-img"))&&(e.style.transform="translate3d("+t+"px, 0, 0)")})},touchStart:function(e){e.slides.forEach(function(e){e.style.transition=""})},setTransition:function(e,t){var o="cubic-bezier(0.25, 0.1, 0.25, 1)";e.slides.forEach(function(e){e.style.transition=t+"ms "+o;e=e.querySelector(".slider-parallax-img");e&&(e.style.transition=t+"ms "+o)})}}})}function gallery(){document.querySelector(".animated-thumb")&&document.querySelectorAll(".animated-thumb").forEach(e=>{lightGallery(e,{selector:".thumb-img",thumbnail:!0,download:!1,height:"100%",width:"100%",iframeMaxWidth:"100%",showCloseIcon:!0,mobileSettings:{controls:!0,showCloseIcon:!0,download:!1}})})}function filterGalleryMobile(){var e=document.querySelector(".fitler-mobile");if(e){let o=e.querySelector(".filter-value-select"),r=e.querySelector(".filter-head"),a=e.querySelector(".filter-body");e=a.querySelectorAll(".nav-link");o&&r&&a&&0!==e.length&&(o.addEventListener("click",()=>{r.classList.toggle("active"),a.classList.toggle("active")}),e.forEach(t=>{t.addEventListener("click",()=>{var e=t.querySelector(".title");e&&(e=e.textContent.trim(),o.textContent=e,r.classList.remove("active"),a.classList.remove("active"))})}))}}function contactForm(){if(!($(".contact-form").length<1)){let r=$("#contact-form"),o=r.find("input[name='name']"),a=r.find("input[name='email']"),i=r.find("input[name='phone']"),n=r.find("textarea[name='message']");r.find("button[type='submit']");r.on("submit",function(e){e.preventDefault(),r.find("input, textarea").removeClass("error");let t=!0;o.val().trim()||(o.addClass("error"),t=!1),a.val().trim()||(a.addClass("error"),t=!1),i.val().trim()||(i.addClass("error"),t=!1),t&&$.ajax({type:"POST",url:ajaxUrl,data:{action:"submit_contact_form",name:o.val().trim(),email:a.val().trim(),phone:i.val().trim(),messageNote:n.val().trim()},beforeSend:function(){},success:function(e){r[0].reset(),r.find(".noti-success").removeClass("d-none"),setTimeout(()=>{r.find(".noti-success").addClass("d-none")},5e3)},error:function(e,t,o){console.error("Lỗi khi gửi form:",o),$(".contact-message").remove(),r.append('<span class="contact-message" style="color: red;">Có lỗi xảy ra, vui lòng thử lại sau.</span>')}})})}}function getNewletter(){$("#form-newletter").on("submit",function(e){e.preventDefault();let t=$(this);var o,e=t.find("input[type='email']");e.removeClass("error"),t.siblings("span").remove(),e.length?(o=e.val()?e.val().trim():"")?$.ajax({type:"POST",url:ajaxUrl,data:{action:"vias_receive_newletter",email:o},beforeSend:function(){console.log("Đang gửi dữ liệu...")},success:function(e){t[0].reset(),t.addClass("d-none"),t.after('<span class="contact-message b3-font d-block color-white" style=" max-width: 235px; margin-top: 16px;">We have received your information, thank you for registering.</span>'),setTimeout(()=>{t.siblings(".contact-message").remove(),t.removeClass("d-none")},5e3)},error:function(e,t,o){console.error("Lỗi khi gửi form:",o),alert("Có lỗi xảy ra, vui lòng thử lại sau.")}}):e.addClass("error"):console.error("Không tìm thấy input email trong form.")})}function swiperNews(){$(".swiper-news").length<1||new Swiper(".swiper-news",{slidesPerView:1,spaceBetween:24,navigation:{nextEl:".news-related .swiper-button-next",prevEl:".news-related .swiper-button-prev"},pagination:{el:".news-related .swiper-pagination",type:"progressbar"},breakpoints:{767:{slidesPerView:3,spaceBetween:40}}})}lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0),$=jQuery;let init=()=>{gsap.registerPlugin(ScrollTrigger),swiperNews(),loading(),header(),footer(),hero(),discover(),customDropdown(),animation(),sectionImage(),sliderParallax(),sectionTestimonials(),gallery(),filterGalleryMobile(),contactForm(),getNewletter(),ScrollTrigger.refresh()};preloadImages("img").then(()=>{init()}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});